USE Cosmos_v14b
GO

IF OBJECT_ID('tempdb..#TESTE_TRAN') IS NOT NULL
BEGIN	
	BEGIN TRAN

		INSERT INTO #TESTE_TRAN
		SELECT '100-x',254.11,100

		INSERT INTO #TESTE_TRAN
		SELECT '453-x',1254.32,1100

	IF @@ERROR <> 0
		ROLLBACK
	ELSE
		COMMIT
END
ELSE
BEGIN

	CREATE TABLE #TESTE_TRAN
	(
		CONTA VARCHAR(5),
		CREDITO NUMERIC(18,2),
		DEBITO NUMERIC(18,2)
	);

	BEGIN TRAN

		INSERT INTO #TESTE_TRAN
		SELECT '100-x',254.11,100

		INSERT INTO #TESTE_TRAN
		SELECT '453-x',1254.32,1100

	IF @@ERROR <> 0
		ROLLBACK
	ELSE
		COMMIT
END

SELECT * FROM #TESTE_TRAN